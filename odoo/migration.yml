migration:
  options:
    backup:
      # Ask to dump-bag to backup the customer database
      # The domain name is resolved by the internal DNS
      command: curl --fail --silent http://server.dump-bag/dump/$database
      stop_on_failure: true
      ignore_if: test -z "$BACKUP_ON_MIGRATION"
  versions:
    - version: setup
      operations:
        post:
          ## PLATFORM
          - anthem odoo.addons.cloud_platform.songs::install_exoscale
          #- anthem songs.install.accounting::main
          #- anthem songs.install.logistics::main
          - anthem songs.install.data_all::main
      modes:
        sample:
          operations:
            pre:
              - odoo -i base --stop-after-init --workers=0 --no-xmlrpc
              - anthem songs.install.pre::main
            post:
              - anthem songs.sample.data_sample::main
      addons:
        upgrade:
          ## PLATFORM
          - cloud_platform_exoscale
          #### core
          - account
          - account_payment
          - analytic
          - attachment_indexation
          - auth_signup
          - barcodes
          - base_address_city
          - base_automation
          - base_iban
          - base_import
          - base_setup
          - base_sparse_field
          - base_vat
          - board
          - bus
          - calendar
          - calendar_sms
          - contacts
          - crm
          - crm_sms
          - delivery
          - digest
          - event
          - event_sale
          - event_sms
          - fetchmail
          - fleet
          - gamification
          - gamification_sale_crm
          - hr
          - hr_attendance
          - hr_contract
          - hr_expense
          - hr_fleet
          - hr_gamification
          - hr_holidays
          - hr_holidays_attendance
          - hr_org_chart
          - hr_recruitment
          - hr_work_entry
          - http_routing
          - iap
          - l10n_ch
          - l10n_ch_qriban
          - l10n_multilang
          - link_tracker
          - mail
          - mail_bot
          - mass_mailing
          - mass_mailing_crm
          - mass_mailing_event
          - mass_mailing_sale
          - mrp
          - mrp_account
          - mrp_subcontracting
          - mrp_subcontracting_account
          - mrp_subcontracting_dropshipping
          - odoo_referral
          - payment
          - payment_transfer
          - phone_validation
          - portal
          - procurement_jit
          - product
          - product_expiry
          - project
          - purchase
          - purchase_mrp
          - purchase_requisition
          - purchase_requisition_stock
          - purchase_stock
          - rating
          - resource
          - sale
          - sale_crm
          - sale_expense
          - sale_management
          - sale_mrp
          - sale_purchase
          - sale_stock
          - sales_team
          - sms
          - snailmail
          - snailmail_account
          - social_media
          - stock
          - stock_account
          - stock_dropshipping
          - stock_picking_batch
          - stock_sms
          - survey
          - uom
          - utm
          - web
          - web_editor
          - web_kanban_gauge
          - web_tour
          - web_unsplash
          #### enterprise
          - account_accountant
          - account_asset
          - account_auto_transfer
          - account_bank_statement_import
          - account_bank_statement_import_camt
          - account_bank_statement_import_csv
          - account_bank_statement_import_ofx
          - account_batch_payment
          - account_followup
          - account_invoice_extract
          - account_invoice_extract_purchase
          - account_online_sync
          - account_plaid
          - account_ponto
          - account_predictive_bills
          - account_reports
          - account_sepa
          - account_sepa_direct_debit
          - account_yodlee
          - analytic_enterprise
          - barcodes_mobile
          - base_automation_hr_contract
          - contacts_enterprise
          - crm_enterprise
          - currency_rate_live
          - delivery_dhl
          - documents_account
          - documents_fleet
          - documents_hr
          - documents_hr_contract
          - documents_hr_holidays
          - documents_hr_recruitment
          - documents_product
          - documents_project
          - event_enterprise
          - helpdesk
          - helpdesk_sale
          - hr_appraisal
          - hr_contract_reports
          - hr_holidays_gantt
          - l10n_ch_reports
          - mail_enterprise
          - mass_mailing_themes
          - mrp_account_enterprise
          - project_enterprise
          - purchase_enterprise
          - sale_enterprise
          - snailmail_account_followup
          - stock_account_enterprise
          - stock_enterprise
          - web_cohort
          - web_dashboard
          - web_enterprise
          - web_gantt
          - web_grid
          - web_map
          - web_mobile
    # update step example
    # - version: 14.0.x.y.z
    #   addons:
    #     upgrade:
    #       - foo_module
    #       - baz_module
    #   operations:
    #     post:
    #       - anthem songs.updates.update_10_0_x_y_z::main
